/* *****************************************************************************
 * File:   ds3231.c
 * Author: Dimitar Lilov
 *
 * Created on 2021 02 25 19:29
 * 
 * Description: ...
 * 
 **************************************************************************** */
#ifdef _WIN32
#pragma once
#endif /* _WIN32 */

/* *****************************************************************************
 * Header Includes
 **************************************************************************** */
#include "ds3231.h"

//#include "mcc_generated_files/mcc.h"
#include "mcc_generated_files/examples/i2c1_master_example.h"

/* *****************************************************************************
 * Configuration Definitions
 **************************************************************************** */

/* *****************************************************************************
 * Constants and Macros Definitions
 **************************************************************************** */

/* *****************************************************************************
 * Enumeration Definitions
 **************************************************************************** */

/* *****************************************************************************
 * Type Definitions
 **************************************************************************** */

/* *****************************************************************************
 * Function-Like Macros
 **************************************************************************** */

/* *****************************************************************************
 * Variables Definitions
 **************************************************************************** */
uint8_t DS3231_au8MemoryGet[32] = {0};
uint8_t DS3231_au8MemorySet[32] = {0};


uint8_t DS3231_au8MessageI2C[33] = {0};


/* *****************************************************************************
 * Prototype of functions definitions
 **************************************************************************** */

/* *****************************************************************************
 * Functions
 **************************************************************************** */
void DS3231_vRTCRead(void)
{
    I2C1_ReadDataBlock(0x68, 0x00,  &DS3231_au8MemoryGet[0], 0x07);
}

void DS3231_vRTCWrite(void)
{
#if 0
    DS3231_au8MessageI2C[0] = 0;                            /* Start Write From Address 0 */
    DS3231_au8MessageI2C[1] = DS3231_au8MemorySet[0];       /* Write Data[0] sec */
    DS3231_au8MessageI2C[2] = DS3231_au8MemorySet[1];       /* Write Data[1] min */
    DS3231_au8MessageI2C[3] = DS3231_au8MemorySet[2];       /* Write Data[2] hour */
    DS3231_au8MessageI2C[4] = DS3231_au8MemorySet[3];       /* Write Data[3] weekday */
    DS3231_au8MessageI2C[5] = DS3231_au8MemorySet[4];       /* Write Data[4] day */
    DS3231_au8MessageI2C[6] = DS3231_au8MemorySet[5];       /* Write Data[5] month */
    DS3231_au8MessageI2C[7] = DS3231_au8MemorySet[6];       /* Write Data[6] year */
    
    
    I2C1_WriteNBytes(0x68, &DS3231_au8MessageI2C[0], (1 + 0x07) );
#else
    I2C1_WriteDataBlock(0x68, 0x00,  &DS3231_au8MemorySet[0], 0x07);
#endif
}
