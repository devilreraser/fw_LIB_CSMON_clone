/* *****************************************************************************
 * File:   memory.c
 * Author: Dimitar Lilov
 *
 * Created on 2019 06 20 23:06
 * 
 * Description: Memory Management
 * 
 **************************************************************************** */



/* *****************************************************************************
 * Header Includes
 **************************************************************************** */
#include "memory.h"
#include "boardcfg.h"
#include "isr.h"

/* *****************************************************************************
 * Configuration Definitions
 **************************************************************************** */
//#define MEMORY_BUFFER_SIZE  2048

/* *****************************************************************************
 * Enumeration Definitions
 **************************************************************************** */



/* *****************************************************************************
 * Type Definitions
 **************************************************************************** */



/* *****************************************************************************
 * Variables Definitions
 **************************************************************************** */
//uint8_t MEMORY_au8Buffer[MEMORY_BUFFER_SIZE];


/* *****************************************************************************
 * Functions Prototypes
 **************************************************************************** */


/* *****************************************************************************
 * Functions Definitions
 **************************************************************************** */

uint8_t* MEMORY_pAlloc(uint16_t u16Size)
{
    //DEBUG_SET_PIN1();
    uint8_t* pu8Result = NULL;
    ISR_vEnterCritical();
    pu8Result = malloc(u16Size);
    ISR_vExitCritical();
    //DEBUG_CLR_PIN1();
    return pu8Result;
}

void MEMORY_vFree(uint8_t* pData)
{    
    //DEBUG_SET_PIN2();
    ISR_vEnterCritical();
    free(pData);
    ISR_vExitCritical();
    //DEBUG_CLR_PIN2();
}


